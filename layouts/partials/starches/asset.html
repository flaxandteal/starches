{{- if not (.Page.Store.Get "asset-style-loaded-flag") -}}
<link href="https://unpkg.com/maplibre-gl@^5.3.1/dist/maplibre-gl.css" rel="stylesheet" />
<link rel="stylesheet" href="{{ "css/map.css" | absURL }}">
<link rel="stylesheet" href="{{ "css/cleangov.css" | absURL }}">
<link rel="stylesheet" href="{{ "pagefind/pagefind-modular-ui.css" | absURL }}" />

{{ $baseAssets := (slice "asset.ts" "search.ts") }}
{{ range $baseAssets }}
{{- $js := resources.Get . -}}
{{ $params := (dict "search_config" site.Params.search_config "is_production" hugo.IsProduction ) }}
{{ $sourceMap := cond hugo.IsProduction "" "inline" }}
{{ $opts := dict "sourceMap" $sourceMap "minify" hugo.IsProduction "target" "es2020" "params" $params }}
{{ $js = $js | js.Build $opts }}
{{ if hugo.IsProduction }}
  {{ $js = $js | fingerprint }}
{{ end }}
<script
  src="{{ $js.RelPermalink }}"
  {{ if hugo.IsProduction }}integrity="{{ $js.Data.Integrity }}"{{ end }}
  type="module">
</script>
{{ end }}
{{- .Page.Store.Set "asset-style-loaded-flag" true -}}
{{- end -}}

<div id="demo-warning">
  This is a front-end demo with full datasets - if you see this banner, potentially-sensitive data will be loaded, even it is not displayed (<a href="#" id="swap-link"></a>)
</div>

<div class="navigation-container">
  <div class="nav-back">
    <a href="{{ site.BaseURL }}" class="govuk-button govuk-button--secondary back-link">Return to Search</a>
    <button class="govuk-button govuk-button--secondary" data-module="govuk-button" onclick="navigator.clipboard.writeText(document.location.href)">
      Copy link
    </button>
  </div>
  <div class="asset-breadcrumbs" id="search-breadcrumbs">
    <span id="breadcrumb-search-term"></span>
    <span id="breadcrumb-filters"></span>
    <span id="breadcrumb-geo"></span>
  </div>
</div>

<div class="modern-navigation" id="top-nav-container">
  <div class="nav-position" id="position-counter-top">
    {{/* Populated by JavaScript */}}
  </div>
  <div class="nav-buttons" id="top-navigation">
    <a href="#" class="govuk-button govuk-button--secondary" id="prev-asset-top" style="display: none;">Previous</a>
    <a href="#" class="govuk-button govuk-button--secondary" id="next-asset-top" style="display: none;">Next</a>
  </div>
</div>

<!-- RMV <div id="map"></div> -->
<h1 id="asset-title"></h1>

<div class="modern-navigation" id="bottom-nav-container">
  <div class="nav-back">
    <a href="{{ site.BaseURL }}" class="govuk-back-link back-link">Return to Search</a>
  </div>
  <div class="nav-position" id="position-counter-bottom">
    {{/* Populated by JavaScript */}}
  </div>
  <div class="nav-buttons" id="bottom-navigation">
    <a href="#" class="govuk-button govuk-button--secondary" id="prev-asset-bottom" style="display: none;">Previous</a>
    <a href="#" class="govuk-button govuk-button--secondary" id="next-asset-bottom" style="display: none;">Next</a>
  </div>
</div>

<article id="asset">
</article>

<dialog id="asset-dialog" aria-labelledby="asset-dialog__heading">
<div id="asset-dialog__heading"></div>

<div id="asset-dialog__content"></div>

<button class="govuk-button dialog-cancel" type="button" id="asset-dialog__cancel"
    onclick="document.getElementById('asset-dialog').close()">Cancel</button>
</dialog>

<div id="legacy-record-container">
<h2>Legacy Record</h2>

<pre id="legacy-record">
</pre>
</div>
